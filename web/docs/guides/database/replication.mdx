---
id: replication
title: "レプリケーション"
slug: replication
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


<<<<<<< HEAD
レプリケーションは、あるデータベースから別のデータベースへデータをコピーする技術です。これは次のような場合に有効です。

- 「負荷」を分散させる。例えば、データベースに多くの読み取りがある場合、2つのデータベースに分割できます。
- 待ち時間の短縮。例えば、ヨーロッパのお客様にはロンドンに、アメリカのお客様にはニューヨークにデータベースを設置したい場合があります。
- Supabaseの場合は、内蔵されているレプリケーション機能を利用して、リアルタイムのAPIを提供しています。
=======
Replication is a technique for copying the data from one database to another. Supabase uses replication functionality to provide a real-time API. Replication is useful for:

- Spreading out the "load." For example, if your database has a lot of reads, you might want to split it between two databases.
- Reducing latency. For example, you may want one database in London to serve your European customers, and one in New York to serve the US.
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

Replication is done through _publications_, a method of choosing which changes to send to other systems (usually another Postgres database). Publications can be managed in the [Dashboard](https://app.supabase.com) or with SQL.

## Manage publications in the Dashboard

<<<<<<< HEAD
## パブリケーション

パブリケーションとは、どの変更を他のシステム（通常は他のPostgresデータベース）に送信するかを選択する方法です。


### パブリケーションの管理

Supabaseはパブリケーションを管理するためのインターフェースを提供していますが、SQLも使用できます。

<Tabs
defaultValue="UI"
values={[
  {label: 'UI', value: 'UI'},
  {label: 'SQL', value: 'SQL'},
]}>
<TabItem value="UI">

```sh
1. 「Database」セクションに移動します。
2. サイドバーにある「Replication」をクリックします。
3. Insert/Update/Deleteのトグルを切り替えることで、どのデータベースのイベントを送信するかを制御します。
4. 「Source」をクリックしてテーブルを切り替えることで、どのテーブルに変更が反映されるかを制御できます。
```
=======
1. Go to the [Database](https://app.supabase.com/project/_/database/tables) page in the Dashboard.
2. Click on **Replication** in the sidebar.
3. Control which database events are sent by toggling **Insert**, **Update**, and **Delete**.
4. Control which tables broadcast changes by selecting **Source** and toggling each table.
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

<video width="99%" muted playsInline controls="true">
<source src="/docs/videos/api/api-realtime.mp4" type="video/mp4" muted playsInline />
</video>

## Create a publication

<<<<<<< HEAD
```sql
alter publication supabase_realtime add table products;
```

</TabItem>
</Tabs>

### パブリケーションを作成

このパブリケーションは、すべてのテーブルに対するすべての変更を含みます。


<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
This publication contains changes to all tables.
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
create publication publication_name 
for all tables;
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### 個々のテーブルを受信するパブリケーションを作成



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Create a publication to listen to individual tables
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
create publication publication_name 
for table table_one, table_two;
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### 既存のパブリケーションにテーブルを追加



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Add tables to an existing publication
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
alter publication publication_name 
add table table_name;
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### `insert`を受信



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Listen to `insert`
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
create publication publication_name 
for all tables
with (publish = 'insert');
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### `update`を受信



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Listen to `update`
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
create publication publication_name 
for all tables
with (publish = 'update');
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### `delete`を受信



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Listen to `delete`
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
create publication publication_name 
for all tables
with (publish = 'delete');
```

<<<<<<< HEAD

</TabItem>

</Tabs>

### パブリケーションを削除



<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
## Remove a publication
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
drop publication if exists publication_name;
```

## Recreate a publication

<<<<<<< HEAD
</TabItem>

</Tabs>

### パブリケーションを再作成

パブリケーションを再作成する場合は、操作が確実に完了するよう、トランザクション内で行うことが最善です。


<Tabs
  defaultValue="sql"
  groupId="reference/postgres"
  values={[{ label: 'SQL', value: 'sql' }]}>

<TabItem value="sql">
=======
If you're recreating a publication, it's best to do it in a transaction to ensure the operation succeeds.
>>>>>>> 792139f8765b04b3c71e6f6ba41a7922fce10b5d

```sql
begin; 
  -- リアルタイム・パブリケーションを削除
  drop publication if exists publication_name; 

  -- パブリケーションを再作成しますが、どのテーブルに対しても有効にしません
  create publication publication_name;  
commit;
```
